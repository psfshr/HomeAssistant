mqtt:
  sensor:
    #-----------------------------------------------
    # New Local MQTT for additional heatpump entries
    #-----------------------------------------------

    # BASV
    - name: "ebusd BASV Cylinder Charge Hysteresis"
      unique_id: sensor.ebusd_basv_cylinder_charge_hysteresis
      state_topic: "ebusd/basv/CylinderChargeHyst"
      value_template: "{{ value_json['value']['value'] }}"
      icon: mdi:thermometer
      unit_of_measurement: "째C"
      state_class: "measurement"
      device_class: "temperature"
      device:
        identifiers: ["vaillant_hp_basv_custom"]
        name: "Heat Pump BASV - Custom"
        manufacturer: "Vaillant"
        model: "aroTHERM Plus"

    - name: "ebusd BASV Cylinder Charge Offset"
      unique_id: sensor.ebusd_basv_cylinder_charge_offset
      state_topic: "ebusd/basv/CylinderChargeOffset"
      value_template: "{{ value_json['value']['value'] }}"
      icon: mdi:thermometer
      unit_of_measurement: "째C"
      state_class: "measurement"
      device_class: "temperature"
      device:
        identifiers: ["vaillant_hp_basv_custom"]

    # HMU
    - name: "ebusd HMU BuildingCircuitFlow"
      unique_id: sensor.ebusd_hmu_buildingcircuitflow
      state_topic: "ebusd/hmu/BuildingCircuitFlow"
      value_template: "{{ ( value_json['value']['value'] | float(0) ) / 60 }}"
      suggested_display_precision: 3
      unit_of_measurement: "L/min"
      state_class: "measurement"
      device_class: "volume_flow_rate"
      icon: mdi:pipe-valve
      device:
        identifiers: ["vaillant_hp_hmu_custom"]
        name: "Heat Pump HMU - Custom"
        manufacturer: "Vaillant"
        model: "aroTHERM Plus"

    - name: "ebusd HMU Run Data High Pressure"
      unique_id: sensor.ebusd_hmu_rundatahighpressure
      state_topic: "ebusd/hmu/RunDataHighPressure"
      value_template: "{{ value_json['value']['value'] }}"
      state_class: "measurement"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_hmu_custom"]

    - name: "ebusd HMU COP HC"
      unique_id: sensor.ebusd_hmu_cophc
      state_topic: "ebusd/hmu/CopHc"
      value_template: "{{ value_json['value']['value'] }}"
      state_class: "measurement"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_hmu_custom"]

    - name: "ebusd HMU COP HC Month"
      unique_id: sensor.ebusd_hmu_cophc_month
      state_topic: "ebusd/hmu/CopHcMonth"
      value_template: "{{ value_json['value']['value'] }}"
      state_class: "measurement"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_hmu_custom"]

    - name: "ebusd HMU COP HWC"
      unique_id: sensor.ebusd_hmu_cophwc
      state_topic: "ebusd/hmu/CopHwc"
      value_template: "{{ value_json['value']['value'] }}"
      state_class: "measurement"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_hmu_custom"]

    - name: "ebusd HMU COP HWC Month"
      unique_id: sensor.ebusd_hmu_cophwc_month
      state_topic: "ebusd/hmu/CopHwcMonth"
      value_template: "{{ value_json['value']['value'] }}"
      state_class: "measurement"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_hmu_custom"]

    - name: "ebusd HMU CurrentError Error"
      unique_id: sensor.ebusd_hmu_currenterror_error
      state_topic: "ebusd/hmu/Currenterror"
      value_template: >
        {% if value_json['error']['value'] is none %}
          OK
        {% else %}
          {{ value_json['error']['value'] }}
        {% endif %}
      icon: mdi:alert-circle
      device:
        identifiers: ["vaillant_hp_hmu_custom"]

    - name: "ebusd HMU CurrentError Error 1"
      unique_id: sensor.ebusd_hmu_currenterror_error_1
      state_topic: "ebusd/hmu/Currenterror"
      value_template: >
        {% if value_json['error_1']['value'] is none %}
          OK
        {% else %}
          {{ value_json['error_1']['value'] }}
        {% endif %}
      icon: mdi:alert-circle
      device:
        identifiers: ["vaillant_hp_hmu_custom"]

    - name: "ebusd HMU CurrentError Error 2"
      unique_id: sensor.ebusd_hmu_currenterror_error_2
      state_topic: "ebusd/hmu/Currenterror"
      value_template: >
        {% if value_json['error_2']['value'] is none %}
          OK
        {% else %}
          {{ value_json['error_2']['value'] }}
        {% endif %}
      icon: mdi:alert-circle
      device:
        identifiers: ["vaillant_hp_hmu_custom"]

    - name: "ebusd HMU CurrentError Error 3"
      unique_id: sensor.ebusd_hmu_currenterror_error_3
      state_topic: "ebusd/hmu/Currenterror"
      value_template: >
        {% if value_json['error_3']['value'] is none %}
          OK
        {% else %}
          {{ value_json['error_3']['value'] }}
        {% endif %}
      icon: mdi:alert-circle
      device:
        identifiers: ["vaillant_hp_hmu_custom"]

    - name: "ebusd HMU CurrentError Error 4"
      unique_id: sensor.ebusd_hmu_currenterror_error_4
      state_topic: "ebusd/hmu/Currenterror"
      value_template: >
        {% if value_json['error_4']['value'] is none %}
          OK
        {% else %}
          {{ value_json['error_4']['value'] }}
        {% endif %}
      icon: mdi:alert-circle
      device:
        identifiers: ["vaillant_hp_hmu_custom"]

    # VR71
    - name: "ebusd VR71 MC1 Operation Status"
      unique_id: sensor.ebusd_vr71_mc1_operation_status
      state_topic: "ebusd/vr_71/Mc1Operation"
      value_template: "{{ value_json['status']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]
        name: "Heat Pump VR71 - Custom"
        manufacturer: "Vaillant"
        model: "aroTHERM Plus"

    - name: "ebusd VR71 MC1 Operation Flow Temp Desired"
      unique_id: sensor.ebusd_vr71_mc1_operation_flow_temp_desired
      state_topic: "ebusd/vr_71/Mc1Operation"
      value_template: "{{ value_json['flowtempdesired']['value'] }}"
      icon: mdi:thermometer
      unit_of_measurement: "째C"
      state_class: "measurement"
      device_class: "temperature"
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 MC1 Operation Pump"
      unique_id: sensor.ebusd_vr71_mc1_operation_pump
      state_topic: "ebusd/vr_71/Mc1Operation"
      value_template: "{{ value_json['pump']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 MC1 Operation Mixer"
      unique_id: sensor.ebusd_vr71_mc1_operation_mixer
      state_topic: "ebusd/vr_71/Mc1Operation"
      value_template: "{{ value_json['mixer']['value'] | int(0) }}"
      icon: mdi:information
      state_class: measurement
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 MC2 Operation Status"
      unique_id: sensor.ebusd_vr71_mc2_operation_status
      state_topic: "ebusd/vr_71/Mc2Operation"
      value_template: "{{ value_json['status']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 MC2 Operation Flow Temp Desired"
      unique_id: sensor.ebusd_vr71_mc2_operation_flow_temp_desired
      state_topic: "ebusd/vr_71/Mc2Operation"
      value_template: "{{ value_json['flowtempdesired']['value'] }}"
      icon: mdi:thermometer
      unit_of_measurement: "째C"
      state_class: "measurement"
      device_class: "temperature"
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 MC2 Operation Pump"
      unique_id: sensor.ebusd_vr71_mc2_operation_pump
      state_topic: "ebusd/vr_71/Mc2Operation"
      value_template: "{{ value_json['pump']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 MC2 Operation Mixer"
      unique_id: sensor.ebusd_vr71_mc2_operation_mixer
      state_topic: "ebusd/vr_71/Mc2Operation"
      value_template: "{{ value_json['mixer']['value'] | int (0) }}"
      icon: mdi:information
      state_class: measurement
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

      #----------------
      # Test Below Here
      #----------------
    - name: "ebusd VR71 SetActorState R1"
      unique_id: sensor.ebusd_vr71_setactorstate_r1
      state_topic: "ebusd/vr_71/SetActorState"
      value_template: "{{ value_json['r1']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 SetActorState R2"
      unique_id: sensor.ebusd_vr71_setactorstate_r2
      state_topic: "ebusd/vr_71/SetActorState"
      value_template: "{{ value_json['r2']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 SetActorState R3"
      unique_id: sensor.ebusd_vr71_setactorstate_r3
      state_topic: "ebusd/vr_71/SetActorState"
      value_template: "{{ value_json['r3']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 SetActorState R4"
      unique_id: sensor.ebusd_vr71_setactorstate_r4
      state_topic: "ebusd/vr_71/SetActorState"
      value_template: "{{ value_json['r4']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 SetActorState R5"
      unique_id: sensor.ebusd_vr71_setactorstate_r5
      state_topic: "ebusd/vr_71/SetActorState"
      value_template: "{{ value_json['r5']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 SetActorState R6"
      unique_id: sensor.ebusd_vr71_setactorstate_r6
      state_topic: "ebusd/vr_71/SetActorState"
      value_template: "{{ value_json['r6']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 SetActorState R7"
      unique_id: sensor.ebusd_vr71_setactorstate_r7
      state_topic: "ebusd/vr_71/SetActorState"
      value_template: "{{ value_json['r7']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 SetActorState R8"
      unique_id: sensor.ebusd_vr71_setactorstate_r8
      state_topic: "ebusd/vr_71/SetActorState"
      value_template: "{{ value_json['r8']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 SetActorState R9"
      unique_id: sensor.ebusd_vr71_setactorstate_r9
      state_topic: "ebusd/vr_71/SetActorState"
      value_template: "{{ value_json['r9']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 SetActorState R10"
      unique_id: sensor.ebusd_vr71_setactorstate_r10
      state_topic: "ebusd/vr_71/SetActorState"
      value_template: "{{ value_json['r10']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 SetActorState R11"
      unique_id: sensor.ebusd_vr71_setactorstate_r11
      state_topic: "ebusd/vr_71/SetActorState"
      value_template: "{{ value_json['r11']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]

    - name: "ebusd VR71 SetActorState R12"
      unique_id: sensor.ebusd_vr71_setactorstate_r12
      state_topic: "ebusd/vr_71/SetActorState"
      value_template: "{{ value_json['r12']['value'] }}"
      icon: mdi:information
      device:
        identifiers: ["vaillant_hp_vr71_custom"]
